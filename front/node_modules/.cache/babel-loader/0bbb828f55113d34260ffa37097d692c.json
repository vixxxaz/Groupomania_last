{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Utilisateur\\\\Desktop\\\\Vincent\\\\front\\\\src\\\\pages\\\\Home\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState, useEffect } from 'react';\nimport axios from '../../api/axios';\nimport { UserContext } from '../../context/userContext';\nimport './index.css';\nimport authHeader from '../../services/auth-header';\nimport { useNavigate } from 'react-router-dom';\nimport Navbar from '../Navbar/index';\nimport * as moment from 'moment';\nimport 'moment/locale/fr';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst REGISTER_URL = '/post';\n\nfunction Home() {\n  _s();\n\n  const [data, setData] = useState([]);\n  const user = localStorage.getItem('user');\n  const {\n    toggleModals,\n    modalState\n  } = useContext(UserContext);\n  const testauthHeader = authHeader();\n  const [validationDel, setValidationDel] = useState('ok');\n  const localeStorageUser = JSON.parse(localStorage.getItem(\"user\"));\n  const navigate = useNavigate();\n\n  const getAllPost = () => {\n    try {\n      if (!localeStorageUser) {\n        toggleModals('signIn');\n      }\n\n      axios.get(REGISTER_URL, {\n        headers: {\n          'Content-Type': 'application/json',\n          \"authorization\": `${testauthHeader.authorization}`\n        }\n      }).then(res => {\n        setData(res.data.reverse());\n      });\n    } catch (err) {\n      if (!(err !== null && err !== void 0 && err.response)) {\n        console.log('erreur serveur');\n      } else {\n        console.log('Echec de la connexion');\n      }\n    }\n  };\n\n  useEffect(() => {\n    getAllPost();\n  }, []); // change like or dislike\n\n  async function LikeDislike(likeDislike, idLikeDislike, userLiked, userDisliked) {\n    const idUser = JSON.parse(user).userId;\n    let number;\n\n    if (userLiked.indexOf(idUser) !== -1 && likeDislike === 'dislike' || userDisliked.indexOf(idUser) !== -1 && likeDislike === 'like') {} else {\n      if (userLiked.indexOf(idUser) === -1 && userDisliked.indexOf(idUser) === -1) {\n        if (likeDislike === 'like') {\n          number = 1;\n        }\n      } else if (userLiked.indexOf(idUser) !== -1 && likeDislike === 'like') {\n        number = 0;\n      }\n\n      try {\n        await axios.post(`${REGISTER_URL}/${idLikeDislike._id}/like`, {\n          'userId': idUser,\n          'like': number\n        }, {\n          headers: {\n            'Content-Type': 'application/json',\n            \"authorization\": `${testauthHeader.authorization}`\n          }\n        }).then(res => {\n          setValidationDel('Youpi');\n          getAllPost();\n        });\n      } catch (err) {\n        if (!(err !== null && err !== void 0 && err.response)) {\n          setValidationDel('erreur serveur');\n        } else {\n          setValidationDel('Echec de la connexion');\n        }\n      }\n    }\n  }\n\n  function localStorageUpdate(idPost) {\n    localStorage.setItem(\"updatePost\", JSON.stringify(idPost));\n    toggleModals('updatePost');\n  }\n\n  function DeletePublication(idPost) {\n    localStorage.setItem(\"updatePost\", JSON.stringify(idPost));\n    toggleModals('delete');\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal \",\n      children: data.map(x => /*#__PURE__*/_jsxDEV(\"article\", {\n        className: \"modal-content\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container-content-text\",\n            children: [(x.userId === localeStorageUser.userId || localeStorageUser.admin) && /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn-close-home\",\n                onClick: () => DeletePublication({\n                  x\n                }),\n                children: \"X\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn-edit-home\",\n                onClick: () => {\n                  localStorageUpdate(x);\n                },\n                children: \"Editer\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"container-dis-like\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: x.usersLiked.indexOf(localeStorageUser.userId) !== -1 ? 'red' : 'grey',\n                onClick: () => LikeDislike('like', x, x.usersLiked, x.usersDisliked),\n                children: [\"Like : \", x.likes]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"truncate-overflow\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [\"  \", moment(x.createdDate).fromNow()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 127,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n                children: [\" \", x.title, \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 128,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"truncate-overflow\",\n                children: x.message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 29\n          }, this), typeof x.imageUrl !== 'undefined' && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"container-content-image\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              alt: x.title,\n              src: x.imageUrl,\n              className: \"image-post\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 25\n        }, this)\n      }, x._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Home, \"WMrgXbmhIr1OBCh4EMDL6/UZvsE=\", false, function () {\n  return [useNavigate];\n});\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["React","useContext","useState","useEffect","axios","UserContext","authHeader","useNavigate","Navbar","moment","REGISTER_URL","Home","data","setData","user","localStorage","getItem","toggleModals","modalState","testauthHeader","validationDel","setValidationDel","localeStorageUser","JSON","parse","navigate","getAllPost","get","headers","authorization","then","res","reverse","err","response","console","log","LikeDislike","likeDislike","idLikeDislike","userLiked","userDisliked","idUser","userId","number","indexOf","post","_id","localStorageUpdate","idPost","setItem","stringify","DeletePublication","map","x","admin","usersLiked","usersDisliked","likes","createdDate","fromNow","title","message","imageUrl"],"sources":["C:/Users/Utilisateur/Desktop/Vincent/front/src/pages/Home/index.jsx"],"sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\nimport axios from '../../api/axios';\nimport { UserContext } from '../../context/userContext'\nimport './index.css'\nimport authHeader from '../../services/auth-header'\nimport { useNavigate } from 'react-router-dom'\nimport Navbar from '../Navbar/index';\n\nimport * as moment from 'moment';\nimport 'moment/locale/fr';\n\nconst REGISTER_URL = '/post';\n\nfunction Home() {\n\n    const [data, setData] = useState([]);\n    const user = localStorage.getItem('user');\n    const { toggleModals, modalState } = useContext(UserContext)\n    const testauthHeader = authHeader();\n    const [validationDel, setValidationDel] = useState('ok');\n    const localeStorageUser = JSON.parse(localStorage.getItem(\"user\"));\n    const navigate = useNavigate();\n\n    const getAllPost = () => {\n        try {\n\n            if (!localeStorageUser) {\n\n                toggleModals('signIn')\n            }\n            axios.get(REGISTER_URL, {\n                headers: {\n                    'Content-Type': 'application/json',\n                    \"authorization\": `${testauthHeader.authorization}`,\n                }\n            })\n                .then(res => {\n                    setData(res.data.reverse())\n\n                })\n        } catch (err) {\n\n            if (!err?.response) {\n                console.log('erreur serveur');\n            } else {\n                console.log('Echec de la connexion');\n            }\n        }\n    }\n\n    useEffect(() => {\n        getAllPost();\n    }, []);\n\n    // change like or dislike\n    async function LikeDislike(likeDislike, idLikeDislike, userLiked, userDisliked) {\n        const idUser = JSON.parse(user).userId;\n        let number;\n        if ((userLiked.indexOf(idUser) !== -1 && likeDislike === 'dislike') || (userDisliked.indexOf(idUser) !== -1 && likeDislike === 'like')) {\n        } else {\n            if (userLiked.indexOf(idUser) === -1 && userDisliked.indexOf(idUser) === -1) {\n\n                if (likeDislike === 'like') {\n                    number = 1;\n                } \n            }  else if (userLiked.indexOf(idUser) !== -1 && likeDislike === 'like') {\n                number = 0;\n            }\n            try {\n                await axios.post(`${REGISTER_URL}/${idLikeDislike._id}/like`, { 'userId': idUser, 'like': number }, {\n                    headers: {\n                        'Content-Type': 'application/json',\n                        \"authorization\": `${testauthHeader.authorization}`,\n                    }\n                })\n                    .then(res => {\n                        setValidationDel('Youpi');\n                        getAllPost();\n                    })\n            } catch (err) {\n                if (!err?.response) {\n                    setValidationDel('erreur serveur');\n                } else {\n                    setValidationDel('Echec de la connexion')\n                }\n            }\n        }\n\n    }\n\n    function localStorageUpdate(idPost) {\n\n        localStorage.setItem(\"updatePost\", JSON.stringify(idPost));\n        toggleModals('updatePost')\n\n    }\n\n\n    function DeletePublication(idPost) {\n\n        localStorage.setItem(\"updatePost\", JSON.stringify(idPost));\n        toggleModals('delete')\n\n    }\n\n    return (\n        <>\n            <Navbar />\n            <div className=\"modal \">\n                {data.map((x) => (\n                    <article key={x._id} className='modal-content'>\n                        <div className='container'>\n                            <div className='container-content-text'>\n                                {(x.userId === localeStorageUser.userId || localeStorageUser.admin) &&\n                                    <>\n                                        <button className='btn-close-home' onClick={() => DeletePublication({ x })}>X</button>\n                                        <button className='btn-edit-home' onClick={() => { localStorageUpdate(x) }} >Editer</button>\n                                    </>}\n                                <div className='container-dis-like'>\n                                    <button className={(x.usersLiked.indexOf(localeStorageUser.userId) !== -1) ? 'red' : 'grey'} onClick={() => LikeDislike('like', x, x.usersLiked, x.usersDisliked)}>\n                                        Like\n                                        : {x.likes}\n                                    </button>\n                                    \n                                </div>\n                                <div className='truncate-overflow'>\n                                    <p>  {moment(x.createdDate).fromNow()}</p>\n                                    < h2 > {x.title} </h2>\n                                    <p className='truncate-overflow' >{x.message}</p>\n                                </div>\n                            </div >\n                            {typeof x.imageUrl !== 'undefined' &&\n                                <div className='container-content-image'>\n                                    <img alt={x.title} src={x.imageUrl} className='image-post' />\n                                </div>\n                            }\n                        </div >\n                    </article>\n                ))\n                }\n            </div >\n        </>)\n}\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module"}